<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>powfacpy.result_variables_parser API documentation</title>
<meta name="description" content="Module to create result variables enumeration classes (see &#39;result_variables.py). The module with the enumeration classes is created by running this …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>powfacpy.result_variables_parser</code></h1>
</header>
<section id="section-intro">
<p>Module to create result variables enumeration classes (see 'result_variables.py). The module with the enumeration classes is created by running this file.
The module is self contained and has only this purpose. It is usually not used by powfacpy users.</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser"><code class="flex name class">
<span>class <span class="ident">ResultVariablesParser</span></span>
</code></dt>
<dd>
<div class="desc"><p>Read (parse) the result variables of PowerFactory .IntMon objects and create enumeration classes (for code completion etc.). The classes are written to the file under 'path_python_res_var_file'. The .txt files under 'path_pf_res_var_txt_files' were created manually by copying from the PF output window when clicking on 'Variable List' in the dialogue of an .IntMon file.
Please have a look at these files for further understanding.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ResultVariablesParser():
  &#34;&#34;&#34;Read (parse) the result variables of PowerFactory .IntMon objects and create enumeration classes (for code completion etc.). The classes are written to the file under &#39;path_python_res_var_file&#39;. The .txt files under &#39;path_pf_res_var_txt_files&#39; were created manually by copying from the PF output window when clicking on &#39;Variable List&#39; in the dialogue of an .IntMon file.
  Please have a look at these files for further understanding.
  &#34;&#34;&#34;
  
  def __init__(self) -&gt; None:
    self.indentation_increment:str = &#34;  &#34;
    self.path_pf_res_var_txt_files:str = r&#39;.\result_variables&#39; 
    self.path_python_res_var_file:str = r&#39;.\src\powfacpy\result_variables.py&#39;
    
  
  def create_results_variables_python_file(self):
    &#34;&#34;&#34;Main method to create the results variables enumeration classes by reading from the .txt files under &#39;path_pf_res_var_txt_files&#39; and writing to the python file under &#39;path_python_res_var_file&#39;.
    In the output python file, a nested class with the hierarchy 
    ResVar -&gt; simulation type -&gt; Elm class 
    is created.
    &#34;&#34;&#34;
    with open(self.path_python_res_var_file, &#39;w&#39;) as out_file:
      module_docstring = self.get_results_variables_module_docstring()
      out_file.write(module_docstring)
      out_file.write(&#34;from aenum import Enum\n\n&#34;)
      out_file.write(&#34;class ResVar:\n&#34;)
      pf_res_var_txt_files = listdir(self.path_pf_res_var_txt_files)
      for pf_sim_type, powfacpy_sim_type in supported_and_unsupported_simulation_types_and_names.items():
        if powfacpy_sim_type:
          out_file.write(&#34;\n\n&#34;)
          out_file.write(self.indentation_increment + &#34;class &#34;+powfacpy_sim_type+&#34;:\n&#34;)
          for res_var_file in pf_res_var_txt_files:
            with open(self.path_pf_res_var_txt_files + &#34;//&#34; + res_var_file, &#39;r&#39;) as in_file:
              out_file.write(&#34;\n&#34;)
              elm_class = res_var_file.split(&#34;.&#34;)[0]
              self.write_elm_class_in_simulation_type(elm_class, in_file, out_file, pf_sim_type)
  
      
  def get_results_variables_module_docstring(self):
    module_docstring = f&#34;&#34;&#34;\&#34;\&#34;\&#34;
This module provides enumeration classes for results variables of &#39;Elm&#39; classes (network elements). This is convenient to get results variable strings and supports code completion in your IDE. If you hover over a variable, it&#39;s unit and description will be shown.  

This file is automatically created using the .txt files in &#39;{self.path_pf_res_var_txt_files}&#39; and using the module &#39;results_varaibles_parser&#39;. The .txt files are created by copying from the output window of PF (manually) using the printed results variables when clicking on &#39;Variable List&#39; in an .IntMon file of an &#39;Elm&#39; class.

Currently, the following &#39;Elm&#39; classes are supported: \n
&#34;&#34;&#34; 
    pf_res_var_files = listdir(self.path_pf_res_var_txt_files)
    for res_var_file in pf_res_var_files:
      module_docstring += res_var_file.split(&#34;.&#34;)[0] + &#34;\n&#34;  
    module_docstring += &#34;\nThe follwing simulation types/result variable types are supported:\n\n&#34;
    for pf_simtype,powfacpy_sim_type in supported_and_unsupported_simulation_types_and_names.items():
      if powfacpy_sim_type:
        module_docstring += pf_simtype + &#34; &#34; +powfacpy_sim_type + &#34;\n&#34;
    module_docstring += &#34;\&#34;\&#34;\&#34;\n&#34;
    return module_docstring


  def write_elm_class_in_simulation_type(self, elm_class:str, in_file, out_file, pf_sim_type:str):
    &#34;&#34;&#34;Write an elm class to the output python file for a specific simulation type. Iterates through the lines of the .txt file until it finds the simulation type. Then writes all its variables to the python files. Breaks the loop as soon as the next simualtion type is reached.
    &#34;&#34;&#34;
    out_file.write(2*self.indentation_increment + &#34;class &#34; + elm_class + &#34;(Enum):\n&#34;)
    out_file.write(3*self.indentation_increment + &#34;_init_ = &#39;value __doc__&#39;\n\n&#34;) # required for enumeration classes with descriptions for each attribute
    write_variables = False
    for line in in_file:
      line = line.rstrip()
      if line in supported_and_unsupported_simulation_types_and_names:
        if line == pf_sim_type:
          write_variables = True
          used_attr = []
        elif write_variables:
          break  
      if write_variables and self.is_line_with_variable(line):
        self.write_variable_line(line, used_attr, out_file)
          
  
  def is_line_with_variable(self, line):
    &#34;&#34;&#34;Lines with variables are identified by the colon and line length. A typical line looks like this:
    m:I2:bus1                kA     Negative-Sequence Current, Magnitude
    &#34;&#34;&#34;
    return len(line) &gt; 1 and line[1] == &#34;:&#34;
          
          
  def write_variable_line(self, line, used_attr, out_file):
    &#34;&#34;&#34;Write one variable to the output python file. 
    Splits the line (that was read in) according to two (or more) empty spaces, that separate attribute, unit (optional) and description.
    The same attributes can occur several times in the simualtion type in the .txt file, so alreay used attributes (&#39;used_attr&#39;) are ignored.
    &#34;&#34;&#34;
    attr_and_unit_and_description = line.split(&#34;  &#34;)
    attr_with_underscores_instead_of_colon = attr_and_unit_and_description[0].replace(&#34;:&#34;,&#34;_&#34;)
    if not attr_with_underscores_instead_of_colon in used_attr:
      used_attr.append(attr_with_underscores_instead_of_colon)
      out_line = 3*self.indentation_increment + attr_with_underscores_instead_of_colon + &#34; = &#34; + &#34;\&#34;&#34; + attr_and_unit_and_description[0] + &#34;\&#34;, \&#34;&#34;
      for n in attr_and_unit_and_description[1:]:
        if n:
          n = n.replace(&#34;\&#34;&#34;,&#34;&#39;&#39;&#34;) # replaces &#34;\&#34;&#34; e.g. in &#34;Ik\&#34;&#34;
          out_line +=  n.rstrip().lstrip() + &#34;, &#34;  # delete leading and trailing whitespace
      out_file.write(out_line[:-2] + &#34;\&#34;\n&#34;) # delete last comma </code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser.create_results_variables_python_file"><code class="name flex">
<span>def <span class="ident">create_results_variables_python_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Main method to create the results variables enumeration classes by reading from the .txt files under 'path_pf_res_var_txt_files' and writing to the python file under 'path_python_res_var_file'.
In the output python file, a nested class with the hierarchy
ResVar -&gt; simulation type -&gt; Elm class
is created.</p></div>
</dd>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser.get_results_variables_module_docstring"><code class="name flex">
<span>def <span class="ident">get_results_variables_module_docstring</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser.is_line_with_variable"><code class="name flex">
<span>def <span class="ident">is_line_with_variable</span></span>(<span>self, line)</span>
</code></dt>
<dd>
<div class="desc"><p>Lines with variables are identified by the colon and line length. A typical line looks like this:
m:I2:bus1
kA
Negative-Sequence Current, Magnitude</p></div>
</dd>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser.write_elm_class_in_simulation_type"><code class="name flex">
<span>def <span class="ident">write_elm_class_in_simulation_type</span></span>(<span>self, elm_class: str, in_file, out_file, pf_sim_type: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Write an elm class to the output python file for a specific simulation type. Iterates through the lines of the .txt file until it finds the simulation type. Then writes all its variables to the python files. Breaks the loop as soon as the next simualtion type is reached.</p></div>
</dd>
<dt id="powfacpy.result_variables_parser.ResultVariablesParser.write_variable_line"><code class="name flex">
<span>def <span class="ident">write_variable_line</span></span>(<span>self, line, used_attr, out_file)</span>
</code></dt>
<dd>
<div class="desc"><p>Write one variable to the output python file.
Splits the line (that was read in) according to two (or more) empty spaces, that separate attribute, unit (optional) and description.
The same attributes can occur several times in the simualtion type in the .txt file, so alreay used attributes ('used_attr') are ignored.</p></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="powfacpy" href="index.html">powfacpy</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="powfacpy.result_variables_parser.ResultVariablesParser" href="#powfacpy.result_variables_parser.ResultVariablesParser">ResultVariablesParser</a></code></h4>
<ul class="">
<li><code><a title="powfacpy.result_variables_parser.ResultVariablesParser.create_results_variables_python_file" href="#powfacpy.result_variables_parser.ResultVariablesParser.create_results_variables_python_file">create_results_variables_python_file</a></code></li>
<li><code><a title="powfacpy.result_variables_parser.ResultVariablesParser.get_results_variables_module_docstring" href="#powfacpy.result_variables_parser.ResultVariablesParser.get_results_variables_module_docstring">get_results_variables_module_docstring</a></code></li>
<li><code><a title="powfacpy.result_variables_parser.ResultVariablesParser.is_line_with_variable" href="#powfacpy.result_variables_parser.ResultVariablesParser.is_line_with_variable">is_line_with_variable</a></code></li>
<li><code><a title="powfacpy.result_variables_parser.ResultVariablesParser.write_elm_class_in_simulation_type" href="#powfacpy.result_variables_parser.ResultVariablesParser.write_elm_class_in_simulation_type">write_elm_class_in_simulation_type</a></code></li>
<li><code><a title="powfacpy.result_variables_parser.ResultVariablesParser.write_variable_line" href="#powfacpy.result_variables_parser.ResultVariablesParser.write_variable_line">write_variable_line</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
